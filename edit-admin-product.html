<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="./admin-product.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.js"
        integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
        integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>
    <aside class="bg-dark">
        <h1 class="fs-3 text-center" style="color: rgb(228, 228, 228);">AdminLTE</h1>
        <hr style="border: 1px solid rgb(236, 236, 236);">
        <ul class="p-0">
            <a href="admin-index.html" class="text-decoration-none">
                <li class="ps-4 pe-4 fs-5 pt-2 pb-2 mainli"><i class="bi bi-speedometer"></i>&nbsp;&nbsp;Dashboard</li>
            </a>
            <li class="mainul1 fs-5 pt-2">
                <div class="w-100 ps-4 pe-4 pt-2 pb-2 parent d-flex align-items-center justify-content-between">
                    <div><i class="bi bi-file-earmark-plus-fill"></i>&nbsp;&nbsp;Add Data</div><i
                        class="fa-solid fa-chevron-right icon1"></i>
                </div>
                <ul class="p-0 innerul1 m-0">
                    <a href="admin-product.html">
                        <li class="d-flex ps-4 pe-4 pt-2 pb-2 mt-1 mb-1 align-items-center gap-3"><i
                                class="bi bi-circle fs-6"></i>Add Product</li>
                    </a>
                </ul>
            </li>
            <li class="mainul2 fs-5 pt-2">
                <div class="w-100 ps-4 pe-4 pt-2 pb-2 parent d-flex align-items-center justify-content-between">
                    <div><i class="bi bi-bar-chart-line-fill"></i>&nbsp;&nbsp;View Data</div><i
                        class="fa-solid fa-chevron-right icon2"></i>
                </div>
                <ul class="p-0 innerul2 m-0">
                    <a href="">
                        <li class="d-flex ps-4 pe-4 pt-2 pb-2 mb-1 mt-1 align-items-center gap-3"><i
                                class="bi bi-circle fs-6"></i>Add Product</li>
                    </a>
                </ul>
            </li>
        </ul>
    </aside>
    <section class="main-content">
        <header class="border border-1 border-secondary d-flex align-items-center gap-3 justify-content-start p-3">
            <i class="bi bi-list" style="cursor: pointer;"></i>
            <a href="" class="text-decoration-none text-dark">Home</a>
        </header>
        <section class="s1 p-4">
            <div class="">
                <div class="row w-100 d-flex justify-content-evenly m-0">
                    <div class="shadow-lg overflow-hidden rounded-3 mt-5 p-0 col-lg-6">
                        <div class="ps-4 pe-4 pt-3 pb-3  bg-warning">
                            <h1 class="fs-6 m-0" style="font-family: Verdana, Geneva, Tahoma, sans-serif;">
                                Add
                                Products</h1>
                        </div>
                        <form action="" class="p-4">
                            <div class="w-100 d-flex flex-column gap-2">
                                <label for="" class="fw-bold">Select Product Brand</label>
                                <select class="form-control shadow-none" id="sel-brand">

                                </select>
                                <span class="ps-2" id="err-brand"></span>
                            </div>
                            <div class="row w-100 d-flex justify-content-between align-items-center m-0">
                                <div class="p-0 col-md-5 d-flex flex-column mt-3 gap-2">
                                    <label for="" class="fw-bold">Product Name</label>
                                    <input type="text" id="prod-name" class="form-control shadow-none"
                                        placeholder="Enter product name">
                                    <span class="ps-2" id="err-name"></span>
                                </div>
                                <div class="p-0 col-md-5 mt-3 d-flex flex-column gap-2">
                                    <label for="" class="fw-bold">Product Price</label>
                                    <input type="text" id="prod-price" class="form-control shadow-none"
                                        placeholder="Enter product price">
                                    <span class="ps-2" id="err-price"></span>
                                </div>
                            </div>
                            <div class="row w-100 d-flex justify-content-between align-items-center m-0">
                                <div class="p-0 col-md-5 mt-3 d-flex flex-column gap-2">
                                    <label for="" class="fw-bold">Offer</label>
                                    <input type="text" id="prod-offer" class="form-control shadow-none"
                                        placeholder="Offer between 1 - 100">
                                    <span class="ps-2" id="err-offer"></span>
                                </div>
                                <div class="p-0 col-md-5 mt-3 d-flex flex-column gap-2">
                                    <label for="" class="fw-bold">Net Content</label>
                                    <input type="text" id="prod-nc" class="form-control shadow-none"
                                        placeholder="Example of 100ml">
                                    <span class="ps-2" id="err-nc"></span>
                                </div>
                            </div>
                            <div class="row w-100 d-flex justify-content-between align-items-center m-0">
                                <div class="p-0 col-md-5 mt-3 d-flex flex-column gap-2">
                                    <label for="" class="fw-bold">Voting</label>
                                    <input type="text" id="prod-voting" class="form-control shadow-none"
                                        placeholder="Voting between 1.1 to 4.5">
                                    <span class="ps-2" id="err-voting"></span>
                                </div>
                                <div class="p-0 col-md-5 mt-3 d-flex flex-column gap-2">
                                    <label for="" class="fw-bold">Rating</label>
                                    <input type="text" id="prod-rating" class="form-control shadow-none"
                                        placeholder="Example of 12326">
                                    <span class="ps-2" id="err-rating"></span>
                                </div>
                            </div>
                            <div class="row w-100 d-flex justify-content-between align-items-center m-0">
                                <div class="col-md-5 p-0 mt-3 d-flex flex-column gap-2">
                                    <label for="" class="fw-bold">Age</label>
                                    <select name="" class="shadow-none form-control" id="sel-age">
                                        <option value="" selected disabled>Select Product wise Age</option>
                                        <option value="All">All</option>
                                        <option value="Elderly">Elderly</option>
                                        <option value="Child">Child</option>
                                    </select>
                                    <span class="ps-2" id="err-age"></span>
                                </div>
                                <div class="col-md-5 p-0 mt-3 d-flex flex-column gap-2">
                                    <label for="" class="fw-bold">Gender</label>
                                    <select name="" class="shadow-none form-control" id="sel-gender">
                                        <option value="" selected disabled>Select Type Product</option>
                                        <option value="Unisex">Unisex</option>
                                        <option value="Female">Female</option>
                                        <option value="Male">Male</option>
                                    </select>
                                    <span class="ps-2" id="err-gender"></span>
                                </div>
                            </div>
                            <div class="row w-100 d-flex justify-content-between align-items-center m-0">
                                <div class="p-0 col-md-5 mt-3 d-flex flex-column gap-2">
                                    <label for="" class="fw-bold">Select Product Image</label>
                                    <input type="file" id="prod-img" accept=".jpg,.png" class="form-control shadow-none">
                                    <span class="ps-2" id="err-img"></span>
                                </div>
                                <div class="p-0 col-md-5 mt-3 d-flex flex-column gap-2">
                                    <label for="" class="fw-bold">Video Link</label>
                                    <input type="text" id="prod-video" placeholder="Enter product video link"
                                        class="form-control shadow-none">
                                    <span class="ps-2" id="err-video"></span>
                                </div>
                            </div>
                            <div class="w-100 mt-3 d-flex flex-column gap-2">
                                <label for="" class="fw-bold">Product Description</label>
                                <input type="text" id="prod-desc" style="height: 70px;" class="form-control shadow-none"
                                    placeholder="Write a description of the product">
                                <span class="ps-2" id="err-desc"></span>
                            </div>
                            <div class="w-100 m-0 row mt-4 d-flex justify-content-between align-items-center">
                                <div class="col-sm-6 mt-3">
                                    <button type="submit" class="btn btn-warning w-100">Update</button>
                                </div>
                                <div class="col-sm-6 mt-3">
                                    <a href="admin-product.html" class="btn btn-warning w-100">Back</a>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="shadow-lg rounded-3 col-lg-5 mt-5 p-4">
                        <h1 class="fs-3 text-primary fw-bold text-decoration-underline"
                            style="font-family: Verdana, Geneva, Tahoma, sans-serif;">Product Preview</h1>
                            <img id="p-img" class="mt-5">
                            <h1 class="fs-5 mt-3"
                                style="font-weight: normal; font-family: Verdana, Geneva, Tahoma, sans-serif;"
                                id="p-name">
                            </h1>
                        <div class="mt-3 d-flex gap-3">
                            <h1 class="fs-6" style="font-weight: normal; font-family: Verdana, Geneva, Tahoma, sans-serif;" id="p-price">
                            </h1>
                            <h1 class="fs-6" style="font-weight: normal; color: green; font-family: Verdana, Geneva, Tahoma, sans-serif;" id="p-offer">
                        </div>
                            </h1>
                            <div class="mt-2 d-flex mb-3 align-items-center justify-content-start gap-2">
                                <div id="p-voting" class="rounded-2 ps-2 pe-2 pt-1 pb-1 gap-1 d-flex align-items-center">
                                  
                                </div>
                                <p class="fs-6 m-0" id="p-rating"></p>
                              </div>            
                            <h1 class="fs-6 mt-3" style="font-weight: normal; font-family: Verdana, Geneva, Tahoma, sans-serif;"
                                id="p-nc"></h1>
                                <h1 class="fs-5 mt-3" style="font-weight: normal; font-family: Verdana, Geneva, Tahoma, sans-serif;" id="p-video">
                                </h1>
                                <h1 class="fs-6 mt-3" style="font-weight: normal; font-family: Verdana, Geneva, Tahoma, sans-serif;"
                                id="p-desc"></h1>
                    </div>
                </div>
            </div>
            </div>
        </section>
        <footer class="p-3 mt-5">
            <h1 class="fs-5 m-0 ps-4" style="font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">Copyright
                &copy; 2024 <span class="text-primary">Yash Baapodara</span></h1>
        </footer>
    </section>

</body>
<script>

    $(document).ready(function () {
        $(".bi-list").click(function () {
            $("aside").toggleClass('aside-menu');
            $(".main-content").toggleClass('section-menu');
            $("aside").removeClass("aside-menu1");
            $(".main-content").removeClass('section-menu1');
        });
        $("aside").addClass("aside-menu1");
        $(".main-content").addClass('section-menu1');

        $(".mainul1").click(function () {
            $(".innerul1").slideToggle(300);
            $(".icon1").toggleClass("add-fa-chevron-right");
            $(".innerul2").slideUp(300);
            $(".icon2").removeClass("add-fa-chevron-right");
        });

        $(".mainul2").click(function () {
            $(".innerul2").slideToggle(300);
            $(".icon2").toggleClass("add-fa-chevron-right");
            $(".innerul1").slideUp(300);
            $(".icon1").removeClass("add-fa-chevron-right");
        });

    });

</script>
<script>

    document.querySelector("#prod-name").addEventListener("input", () => {
        document.querySelector("#p-name").innerHTML = document.querySelector("#prod-name").value;
    });

    document.querySelector("#prod-price").addEventListener("input", () => {
        document.querySelector("#p-price").innerHTML = "MRP " + "&#8377;" +document.querySelector("#prod-price").value;
    });

    document.querySelector("#prod-offer").addEventListener("input", () => {
        document.querySelector("#p-offer").innerHTML = document.querySelector("#prod-offer").value +"% off";
    });

    document.querySelector("#prod-nc").addEventListener("input", () => {
        document.querySelector("#p-nc").innerHTML = document.querySelector("#prod-nc").value;
    });

    document.querySelector("#prod-voting").addEventListener("input", () => {
        let vote = document.querySelector("#prod-voting").value;
        document.querySelector("#p-voting").innerHTML = `<h1 class="fs-6 m-0 text-white">${vote}</h1><i class="bi bi-star-fill text-light" style="font-size: 12px;"></i>`;
        document.querySelector("#p-voting").setAttribute("style","background: green; width: fit-content;");
    });

    document.querySelector("#prod-rating").addEventListener("input", () => {
        document.querySelector("#p-rating").innerHTML = document.querySelector("#prod-rating").value +" ratings";
    });

    document.querySelector("#prod-img").addEventListener("input", () => {
        let d = document.querySelector("#prod-img").files;
        // console.log(d[0].name);
        document.querySelector("#p-img").setAttribute("src",`images/${d[0].name}`);
        document.querySelector("#p-img").setAttribute("width","170px");
        document.querySelector("#p-img").setAttribute("height","250px");
    });

    document.querySelector("#prod-desc").addEventListener("input", () => {
        document.querySelector("#p-desc").innerHTML = document.querySelector("#prod-desc").value;
    });

    let url = new URLSearchParams(window.location.search);
    let prodId = url.get("id");
    let imageDefault = "";

    fetch(`http://localhost:3000/weekProducts/${prodId}`)
    .then((res)=>res.json())
    .then((res)=>{
        document.querySelector("#prod-name").value = res.imageTitle;
        document.querySelector("#prod-price").value = res.Price;
        document.querySelector("#prod-offer").value = res.Offer;
        checkBrand(res.Brand);
        imageDefault = res.imagePath;
        document.querySelector("#prod-nc").value = res.NetContent;
        document.querySelector("#prod-voting").value = res.Voting;

        document.querySelector("#sel-age").innerHTML = (res.Age == "All") ? `<option selected value="All">All</option><option value="Elderly">Elderly</option><option value="Child">Child</option>` : (res.Age == "Elderly") ? `<option value="All">All</option><option selected value="Elderly">Elderly</option><option value="Child">Child</option>` : `<option value="All">All</option><option value="Elderly">Elderly</option><option selected value="Child">Child</option>`;

        document.querySelector("#sel-gender").innerHTML = (res.Gender == "Unisex") ? `<option selected value="Unisex">Unisex</option><option value="Female">Female</option><option value="Male">Male</option>` : (res.Gender == "Female") ? `<option value="Unisex">Unisex</option><option selected value="Female">Female</option><option value="Male">Male</option>` : `<option value="Unisex">Unisex</option><option value="Female">Female</option><option selected value="Male">Male</option>`;

        document.querySelector("#prod-rating").value = res.Ratings;
        document.querySelector("#prod-video").value = res.video;
        document.querySelector("#prod-desc").value = res.Desc;
    })
    .catch((err)=>{
        console.log(err);
    })

    document.querySelector("form").addEventListener("submit", (e) => {
        e.preventDefault();

        let brand = document.querySelector("#sel-brand").value;
        let name = document.querySelector("#prod-name").value;
        let price = document.querySelector("#prod-price").value;
        let offer = document.querySelector("#prod-offer").value;
        let nc = document.querySelector("#prod-nc").value;
        let age = document.querySelector("#sel-age").value;
        let gender = document.querySelector("#sel-gender").value;
        let voting = document.querySelector("#prod-voting").value;
        let rating = document.querySelector("#prod-rating").value;
        let image = document.querySelector("#prod-img");
        let video = document.querySelector("#prod-video").value;
        let desc = document.querySelector("#prod-desc").value;

        let obj = {
            imagePath: (image.files.length > 0) ? "./images/"+image.files[0].name : imageDefault,
            imageTitle: name,
            video: video,
            Price: price,
            Brand: brand,
            NetContent: nc,
            Age: age,
            Gender: gender,
            Voting: voting,
            Ratings: rating,
            Offer: offer,
            Desc: desc
        }

        fetch(`http://localhost:3000/weekProducts/${prodId}`, {
            method: "PUT",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(obj)
        })
        .then((res) => res.json())
        .then((res) => {
            console.log("success");
            // console.log(res);
            window.location.href = "admin-product.html";
            document.querySelector("#prod-name").value = "";
            document.querySelector("#prod-price").value = "";
            document.querySelector("#prod-offer").value = "";
            document.querySelector("#prod-nc").value = "";
            document.querySelector("#prod-voting").value = "";
            document.querySelector("#prod-rating").value = "";
            document.querySelector("#prod-img").value = "";
            document.querySelector("#prod-video").value = "";
            document.querySelector("#prod-desc").value = "";
        })
        .catch((err) => {
            console.log(err);
        });

    });

    function checkBrand(id)
    {
        fetch(`http://localhost:3000/healthConcerns/`)
        .then((res)=>res.json())
        .then((res)=>{
            d = "";
            res.forEach((el,i)=>{
                if(el.id == id)
                {
                    d += `<option selected value="${el.id}">${el.imageTitle}</option>`;
                }
                else
                {
                    d += `<option value="${el.id}">${el.imageTitle}</option>`;
                }
            });
            document.querySelector("#sel-brand").innerHTML = d;
            // console.log(d);
        })
    }

</script>

</html>